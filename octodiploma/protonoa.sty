% набор стилевых команд, улучшающих общий вид результата
% 15 X 2006

% классовые опции

\newif\if@russify
\DeclareOption{russify}{\@russifytrue}
\DeclareOption{norussify}{\@russifyfalse}

\newif\if@hlink
\DeclareOption{hlink}{\@hlinktrue}
\DeclareOption{nohlink}{\@hlinkfalse}

\ExecuteOptions{norussify,nohlink}
\ProcessOptions

\unitlength=1mm

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{2}

\usepackage[nomove]{overcite}
\def\@citess#1{\textsuperscript{~\emph{(#1)}}}

% пункты библиографии также курсивом, и без скобок
\renewcommand{\@biblabel}[1]{\emph{#1}.\hfill}


% увеличение размера страницы
    \setlength{\topmargin}{-20mm}
    \setlength{\oddsidemargin}{11mm}
    \setlength{\evensidemargin}{0mm}
    \setlength{\textwidth}{170mm}
    \setlength{\textheight}{260mm}
    \setlength{\hoffset}{-10mm}
% в файле article.cls по умолчанию установлена опция a4paper


% продвинутые возможности таблиц
 \usepackage{array}
 \extrarowheight=4pt
 \def\bvline{\vrule \@width 1pt}
 \def\bhline{%
  \noalign{\ifnum0=`}\fi\hrule \@height 1pt \futurelet
   \reserved@a\@xhline}
\def\@xhline{\ifx\reserved@a\hline
               \vskip\doublerulesep
               \vskip-1pt
             \fi
      \ifnum0=`{\fi}}

\setlength\arraycolsep{5\p@}
\setlength\tabcolsep{5\p@}
\setlength\arrayrulewidth{.4\p@}
\setlength\doublerulesep{2\p@}
\setlength\tabbingsep{\labelsep}
\skip\@mpfootins = \skip\footins
\setlength\fboxsep{3\p@}
\setlength\fboxrule{.4\p@}

% подчинение сносок страницам
\@addtoreset{footnote}{page}
% символьное обозначение сносок
\def\SymbFoot#1{\@SymbFoot{\@nameuse {c@#1}}}
\def\@SymbFoot#1{\ifcase #1\or *\or **\or ***\or ****\or †\or ††\or †††\or ††††\or ‡\or ‡‡\or ‡‡‡\or ‡‡‡‡\or §\or \#\or ¤\@ctrerr  \fi}
\renewcommand\thefootnote{\@SymbFoot\c@footnote}

% точка вместо двоеточия в подписях к рисункам и таблицам
\renewcommand{\@makecaption}[2]{%
\vspace{\abovecaptionskip}%
\sbox{\@tempboxa}{\emph{#1}. \emph{#2.}}%
\ifdim \wd\@tempboxa >\hsize%
    \emph{#1}. \emph{#2.} \par
\else
    \global\@minipagefalse
    \hbox to \hsize {\hfil \emph{#1}. \emph{#2.}\hfil}%
\fi
\vspace{\belowcaptionskip}}

% нормальные интервалы в списках
\renewcommand{\@listI}{\leftmargin=25pt
\rightmargin=0pt
\labelsep=5pt
\labelwidth=10pt
\itemindent=0pt
\listparindent=0pt
\topsep=8pt plus 2pt minus 4pt
\partopsep=2pt plus 1pt minus 1pt
\parsep=0pt plus 1pt
\itemsep=\parsep
}

\renewcommand{\@listii}{\leftmargin=25pt
\topsep=2pt plus 1pt minus 1pt
\partopsep=2pt plus 1pt minus 1pt
}


\usepackage{amsmath,amssymb}

\newcommand{\dg}{^\circ}
\newcommand{\Rot}[1]{\mathop{\rm rot} #1}
\newcommand{\Grad}[1]{\mathop{\rm grad} #1}
\newcommand{\PD}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\PDD}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\defeq}{\mathop{=}\limits^{\rm def}}
\newcommand{\In}{\mathop{\int}\limits_{-\infty}^{+\infty}}
\newcommand{\Iint}{\mathop{\iint}\limits_{-\infty}^{+\infty}}
\newcommand{\sinc}{\mathop{\rm sinc}\nolimits}
\newcommand{\ctg}{\mathop{\rm ctg}\nolimits}
\newcommand{\tg}{\mathop{\rm tg}\nolimits}
\newcommand{\abs}[1]{\mathop{\left|#1\right|}\nolimits}
\newcommand{\const}{\mathop{\rm const}\nolimits}
\newcommand{\Ohm}{\mathbf{\Omega}}

\newcommand{\chf}[1]{$\mathrm{#1}$}


\newcommand{\chf}[1]{$\mathrm{#1}$}


% не нумеруемый раздел
\newcommand{\TOCitem}[1]{\section*{#1}\addcontentsline{toc}{section}{#1}}

% нумерованный список из обычных параграфов
\newcounter{tmpl}
\newenvironment{numparagraphs}{\begin{list}{\arabic{tmpl}}{\leftmargin=\rightmargin \itemindent=2\parindent \parsep=\parskip  \usecounter{tmpl}}}{\end{list}}


% ----------------------------------------
% умное добавление точек после номера раздела
% взято из пакета "russcorr.sty" Львовского
\def\@seccntformat#1{\csname pre#1\endcsname\csname the#1\endcsname \csname post#1\endcsname}
\let\@Tocseccntformat\@seccntformat
\def\@postskip@{\hskip.25em\relax}
\def\postsection{.\@postskip@}
\def\postsubsection{.\@postskip@}
\def\postsubsubsection{.\@postskip@}
\def\postparagraph{.\@postskip@}
\def\postsubparagraph{.\@postskip@}
\def\presection{}
\def\presubsection{}
\def\presubsubsection{}
\def\preparagraph{}
\def\presubparagraph{}

% этот кусок кода нужен, чтобы точки ставились в оглавлении
\def\@sect#1#2#3#4#5#6[#7]#8{%
  \ifnum #2>\c@secnumdepth
    \let\@svsec\@empty
  \else
    \refstepcounter{#1}%
    \protected@edef\@svsec{\@seccntformat{#1}\relax}%
  \fi

  \@tempskipa #5\relax
  \ifdim \@tempskipa>\z@
    \begingroup
      \sloppy
      #6{%
        \@hangfrom{\hskip #3\relax\@svsec}%
          \interlinepenalty \@M #8\@@par}%
    \endgroup
    \csname #1mark\endcsname{#7}%
    \addcontentsline{toc}{#1}{%
      \ifnum #2>\c@secnumdepth \else
        \protect\numberline{\@Tocseccntformat{#1}}%
      \fi
      #8}%
  \else
    \def\@svsechd{%
      #6{\hskip #3\relax
      \@svsec #8}%
      \csname #1mark\endcsname{#7}%
      \addcontentsline{toc}{#1}{%
        \ifnum #2>\c@secnumdepth \else
          \protect\numberline{\@Tocseccntformat{#1}}%
        \fi
        #8}}%
  \fi
  \@xsect{#5}}

\def\@ssect#1#2#3#4#5{%
  \@tempskipa #3\relax
  \ifdim \@tempskipa>\z@
    \begingroup
      \sloppy
      #4{%
        \@hangfrom{\hskip #1}%
          \interlinepenalty \@M #5\@@par}%
    \endgroup
  \else
    \def\@svsechd{#4{\hskip #1\relax #5}}%
  \fi
  \@xsect{#3}}
% ----------------------------------------


% счетчики кириллицей

\def\Сyril#1{\@Cyril{\@nameuse {c@#1}}}
\def\@Cyril#1{\ifcase #1\or А\or Б\or В\or Г\or Д\or Е\or Ж\or З\or И\or Й\or К\or Л\or М\or
Н\or О\or П\or Р\or С\or Т\or У\or Ф\or Х\or Ц\or Ч\or Ш\or Щ\or Ы\or
Ю\or Э\or Я\else\@ctrerr  \fi
}

\def\cyril#1{\@cyril{\@nameuse {c@#1}}}
\def\@cyril#1{\ifcase #1\or а\or б\or в\or г\or д\or е\or ж\or з\or и\or й\or к\or л\or м\or
н\or о\or п\or р\or с\or т\or у\or ф\or х\or ц\or ч\or ш\or щ\or ы\or
ю\or э\or я\else\@ctrerr  \fi
}



% колонтитулы
\renewcommand{\@oddhead}{}
\renewcommand{\@evenhead}{}
\renewcommand{\@oddfoot}{\hfill \textbf{--\,\thepage\,--} \hfill}
\renewcommand{\@evenfoot}{\hfill \textbf{--\,\thepage\,--} \hfill}

\if@russify

    \frenchspacing
    \righthyphenmin=2

    \renewenvironment{subequations}{%
    \refstepcounter{equation}%
    \protected@edef\theparentequation{\theequation}%
    \setcounter{parentequation}{\value{equation}}%
    \setcounter{equation}{0}%
    \def\theequation{\theparentequation.\emph{\cyril{equation}}}%
    \ignorespaces
    }{%
    \setcounter{equation}{\value{parentequation}}%
    \ignorespacesafterend
    }

    \def\today{\number\day\space
                    \ifcase\month\or
                    января\or февраля\or марта\or апреля\or мая\or
                    июня\or июля\or августа\or сентября\or октября\or
                    ноября\or декабря\fi\space\number\year\space г.}

    \renewcommand{\partname}{Часть}
    \renewcommand{\partitionname}{Раздел}
    \renewcommand{\chaptername}{Глава}
    \renewcommand{\contentsname}{Оглавление}
    \renewcommand{\figurename}{Рис.}
    \renewcommand{\tablename}{Таблица}
    \renewcommand{\appendixname}{Приложение}
    \renewcommand{\refname}{Список литературы}
    \renewcommand{\bibname}{Список литературы}
    \renewcommand{\listtablename}{Список таблиц}
    \renewcommand{\listfigurename}{Список иллюстраций}
    \renewcommand{\appendixname}{Приложение}
    \renewcommand{\abstractname}{Аннотация}
    \renewcommand{\indexname}{Предметный указатель}

    \renewcommand{\theenumii}{\cyril{enumii}}
    \renewcommand{\theenumiii}{\Roman{enumiii}}
\fi

% нумерация уравнений внутри секций
% задается опцией "obeyeq2sec"
\if@obey
    \@addtoreset{equation}{section}
    \renewcommand{\theequation}{\arabic{section}.\arabic{equation}}
\fi

% включение гиперссылок в pdf
% задается опцией "hlink"
\if@hlink
    \usepackage[pdftex]{hyperref}
    \hypersetup{
        colorlinks=true,
        linkcolor=blue,
        pdfpagemode=None,
    }
\fi

% эпиграф
\newcommand{\epigraph}[2]{ \begin{flushright} \parbox{0.5\textwidth}{\parindent=2em \emph{#1}}\\ \bigskip #2 \end{flushright} }

% выделение параграфа чертой слева
\newlength{\shirina}
\newlength{\raznost}
\newcommand{\markedpar}[1]{
\begin{flushleft}
\shirina=\textwidth
\settowidth{\raznost}{\vrule width 1pt\relax\hspace{1em}}
\addtolength{\shirina}{-2\raznost}
\noindent\hbox{%
\vrule width 1pt\relax\hspace{1em}\parbox{\shirina}{#1}}
\end{flushleft}}


% красивая горизонтальная линейка разной высоты
\newcommand{\beautifulline}{
\begin{center}
\rule{0.1\textwidth}{.4pt}%
\raisebox{-.2pt}{\rule{0.15\textwidth}{.8pt}}%
\raisebox{-.4pt}{\rule{0.25\textwidth}{1.2pt}}%
\raisebox{-.2pt}{\rule{0.15\textwidth}{.8pt}}%
\rule{0.1\textwidth}{.4pt}%
\end{center}}





